<!DOCTYPE html>
<html lang='en'>
    <head>
        <meta charset='utf-8' />
        <link rel="stylesheet" href="static/dropdown.css" />
        <link rel="stylesheet" href="static/slider.css" />
        <script src='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.20/index.global.min.js'></script>
        <script>
            function timeStr(date) {
                var hoursRaw = date.getHours() % 12;
                var hours = hoursRaw == 0 ? 12 : hoursRaw;
                var minutes = String(date.getMinutes()).padStart(2, "0");
                var period = date.getHours() < 12 ? "a" : "p";
                return `${hours}:${minutes}${period}`;
            }

            function showtimeToEvent(showtime) {
                var title = showtime["title"];
                if (showtime["format"] != "Standard") {
                    title = `[${showtime["format"]}] ${title}`
                }
                return {
                    "title": title,
                    "start": showtime["start_time"],
                    "end": showtime["end_time"],
                    "extendedProps": {
                        "showtime": showtime
                    }
                }
            }

            function showtimesToEvents(showtimes) {
                return showtimes.map(showtimeToEvent);
            }


            function baseShowtimeToEventSource(title, events, displayInfo) {
                return {
                    "id": title,
                    "events": events,
                    "backgroundColor": displayInfo[title]["background_color"],
                    "textColor": displayInfo[title]["text_color"]
                }
            }

            function showtimeToEventSource(showtime, displayInfo) {
                return baseShowtimeToEventSource(showtime["title"], [showtimeToEvent(showtime)], displayInfo);
            }

            function showtimesToEventSources(showtimes, displayInfo) {
                var showtimesByTitle = Object.groupBy(showtimes, (evt) => evt["title"]);
                return Object.entries(showtimesByTitle).map(([title, showtimes]) => {
                    return baseShowtimeToEventSource(title, showtimesToEvents(showtimes), displayInfo);
                });
            }

            async function request(method, path, bodyJson) {
                const url = `/${path}`;
                try {
                    const response = await fetch(url, {method: method, headers: {"Content-Type": "application/json"}, body: JSON.stringify(bodyJson)});
                    if (!response.ok) {
                        throw new Error(`Response status: ${response.status}`);
                    }

                    if (response.headers.get("content-type") == "application/json") {
                        const result = await response.json();
                        return result;
                    } else {
                        const result = await response.text();
                        return result;
                    }
                } catch (error) {
                    console.error(error.message);
                }
                return {};
            }
            async function get(path) {
                const result = await request("GET", path);
                return result;
            }

            async function post(path, bodyJson) {
                const result = await request("POST", path, bodyJson);
                return result;
            }

            async function put(path, bodyJson) {
                const result = await request("PUT", path, bodyJson);
                return result;
            }

            async function hideMovie(title) {
                const result = put(`movies/${encodeURIComponent(title)}/hide`);
                return result;
            }

            async function showMovie(title) {
                const result = put(`movies/${encodeURIComponent(title)}/show`);
                return result;
            }

            async function addAllToCalendar(calendar, filterFunc) {
                var theater = selectedTheater();
                var startTime = calendar.formatIso(calendar.view.activeStart);
                var endTime = calendar.formatIso(calendar.view.activeEnd);
                return getSchedule(theater, startTime, endTime)
                    .then(function(result) {
                        var displayInfo = result["display"];
                        return result["showtimes"]
                            .filter((showtime) => displayInfo[showtime["title"]]["visible"] && filterFunc(showtime))
                            .forEach((showtime) => {
                                var eventSource = calendar.getEventSourceById(showtime["title"]);
                                if (eventSource === null) {
                                    calendar.addEventSource(showtimeToEventSource(showtime, displayInfo));
                                } else {
                                    calendar.addEvent(showtimeToEvent(showtime), eventSource);
                                }
                            });
                    });
            }

            async function getSchedule(theater, startTime, endTime) {
                const result = await get(`showtimes/${encodeURIComponent(theater)}/${startTime}/${endTime}`);
                return result;
            }

            async function getMovieSchedule(theater, title, startTime, endTime) {
                const result = await get(`showtimes/${encodeURIComponent(theater)}/${startTime}/${endTime}`);
                result["showtimes"] = result["showtimes"].filter((showtime) => showtime["title"] === title);
                return result;
            }

            function resetMovieList() {
                var movieListEl = document.getElementById("movie-list");
                movieListEl.innerHTML = "<div id=\"shown-movies\"></div><div id=\"hidden-movies\"></div>";
            }

            function clearCalendar(calendar) {
                resetMovieList();
                calendar.getEventSources().forEach((eventSource, i) => eventSource.remove());
            }

            function selectedTheater() {
                var rawTheater = document.getElementById("theater-selected").innerHTML;
                return rawTheater === undefined || rawTheater == null ? "AMC Methuen" : rawTheater;
            }

            function toggle_is_checked(toggleEl) {
                if (typeof toggleEl === "string") {
                    toggleEl = document.getElementById(toggleEl);
                }
                return toggleEl.querySelector("label input").checked;
            }

            function createToggleSlider(calendar, id, prop, value) {
                var value = value === undefined ? true : value;
                var toggleEl = document.getElementById(id)
                toggleEl.addEventListener("change", function (e) {
                    if (toggle_is_checked(toggleEl)) {
                        addAllToCalendar(calendar, (showtime) => showtime[prop] === value);
                    } else {
                        calendar.getEvents().forEach((event) => {
                            if (event.extendedProps["showtime"][prop] === value) {
                                event.remove();
                            }
                        });
                    }
                });
                return toggleEl;
            }

            function createToggleElement(id, label, initialChecked) {
                var initialChecked = initialChecked === undefined ? true : initialChecked;
                var checkboxEl = Object.assign(document.createElement("input"), {type: "checkbox", checked: initialChecked});
                var sliderEl = Object.assign(document.createElement("span"), {className: "slider round"});
                var switchEl = Object.assign(document.createElement("label"), {className: "switch"});
                switchEl.style.verticalAlign = "middle";
                switchEl.appendChild(checkboxEl);
                switchEl.appendChild(sliderEl);

                var labelEl = Object.assign(document.createElement("label"), {innerHTML: label});
                Object.assign(labelEl.style, {display: "inline-block", verticalAlign: "middle", marginLeft: "4px"});

                var toggleEl = Object.assign(document.createElement("div"), {id: id});
                toggleEl.dataset.label = label;
                toggleEl.appendChild(switchEl);
                toggleEl.appendChild(labelEl);

                return toggleEl;
            }

            function applyShowtimeFilters(showtimes, displayInfo) {
                var negativeFilters = Array.from(document.getElementById("negative-filter-toggles").children)
                    .filter((el) => !toggle_is_checked(el.id))
                    .map((el) => el.dataset.field);
                var enabledFormats = Array.from(document.getElementById("format-filter-toggles").children)
                    .filter((el) => toggle_is_checked(el.id))
                    .map((el) => el.dataset.label);
                return showtimes.filter((showtime) => {
                    return displayInfo[showtime["title"]]["visible"] && !negativeFilters.some((field) => showtime[field]) && enabledFormats.includes(showtime["format"]);
                });
            }

            function updateFiltersByType(parentId, filterDefinitions, showtimesCalendar, listingCalendar, showtimes, displayInfo, updateDisplay) {
                var parentEl = document.getElementById(parentId);
                filterDefinitions.forEach(([label, field, value]) => {
                    var filterFunc = (s) => s[field] === value;
                    var id = `${label.toLowerCase().replace(" ", "-")}-toggle`;
                    var toggleEl = document.getElementById(id);
                    if (toggleEl === null) {
                        toggleEl = createToggleElement(id, label);
                        toggleEl.dataset.field = field;
                        toggleEl.dataset.value = value;

                        var openListingButton = createMovieListOpenListingButton(
                            showtimesCalendar, listingCalendar, displayInfo, filterFunc);
                        openListingButton.style.marginRight = "10px";
                        openListingButton.style.float = "right";
                        toggleEl.appendChild(openListingButton);

                        parentEl.appendChild(toggleEl);

                        createToggleSlider(showtimesCalendar, id, field, value);
                    }

                    var filteredShowtimes = showtimes.filter(filterFunc);
                    if (updateDisplay) {
                        if (filteredShowtimes.length > 0) {
                            toggleEl.style.removeProperty("display");
                        } else {
                            toggleEl.style.display = "none";
                        }
                    }

                    var switchEl = toggleEl.querySelector("label.switch");
                    if (filteredShowtimes.some((s) => displayInfo[s["title"]]["visible"])) {
                        switchEl.classList.remove("disabled");
                    } else {
                        switchEl.classList.add("disabled");
                    }
                });
            }

            function reloadDisplayInfo() {
                var movieList = Array.from(document.getElementById("shown-movies").children).concat(
                    Array.from(document.getElementById("hidden-movies").children));

                return Object.fromEntries(movieList.map((el) => [
                    el.dataset.title,
                    {"visible": el.dataset.visible === "true", "background_color": el.style.background, "text_color": el.style.color}
                ]));
            }

            function updateFilters(showtimesCalendar, listingCalendar, showtimes, displayInfo) {
                var updateDisplay = showtimes !== undefined;
                var showtimes = showtimes === undefined ? showtimesCalendar.getEvents().map((e) => e.extendedProps["showtime"]) : showtimes;
                var displayInfo = displayInfo === undefined ? reloadDisplayInfo() : displayInfo;

                var newFormats = Array.from(new Set(showtimes.map((s) => s["format"])));
                var oldFormats = Array.from(document.getElementById("format-filter-toggles").children).map((el) => el.dataset.label);
                var formatFilters = newFormats.concat(oldFormats).toSorted().map((fmt) => [fmt, "format", fmt]);
                updateFiltersByType("format-filter-toggles", formatFilters, showtimesCalendar, listingCalendar, showtimes, displayInfo, updateDisplay);

                var negativeFilters = [["Open Captions", "is_open_caption", true], ["No A-List", "no_alist", true]];
                updateFiltersByType("negative-filter-toggles", negativeFilters, showtimesCalendar, listingCalendar, showtimes, displayInfo, updateDisplay);
            }

            function openListingClickHandler(event, showtimesCalendar, listingCalendar, displayInfo, showtimeFilter) {
                event.stopPropagation();

                var startStr = showtimesCalendar.formatIso(showtimesCalendar.view.activeStart);
                var endStr = showtimesCalendar.formatIso(showtimesCalendar.view.activeEnd);
                var theater = selectedTheater();
                var title = event.currentTarget.parentNode.dataset.title;

                var showtimeFilter = showtimeFilter === undefined ? (s) => s["title"] === title : showtimeFilter;

                listingCalendar.gotoDate(startStr);
                getSchedule(theater, startStr, endStr)
                    .then((result) => result["showtimes"].filter(showtimeFilter))
                    .then(function(showtimes) {
                        showtimesToEventSources(showtimes, displayInfo).forEach((eventSource) =>
                            listingCalendar.addEventSource(eventSource)
                        );

                        listingCalendar.render();
                    });
            }

            function createMovieListOpenListingButton(showtimesCalendar, listingCalendar, displayInfo, showtimeFilter) {
                var openListingEl = document.createElement('button');
                openListingEl.style.cursor = "pointer";
                openListingEl.style.backgroundColor = "transparent";
                openListingEl.style.borderWidth = "1px";
                openListingEl.innerHTML = "&#x1f4c5";
                openListingEl.style.maxHeight = "21px";
                openListingEl.popoverTargetElement = document.getElementById("movie-showtime-listing");
                openListingEl.addEventListener("click", (e) => {
                    return openListingClickHandler(e, showtimesCalendar, listingCalendar, displayInfo, showtimeFilter)
                });
                return openListingEl;
            }

            function createMovieListTitleEl(title) {
                var titleEl = document.createElement("div");
                titleEl.innerHTML = title;
                titleEl.style.flex = "80%";
                return titleEl;
            }

            function movieListClickHandler(showtimesCalendar, listingCalendar, movieListEl, entry, movieDisplayInfo) {
                function insertSortedChild(parentId, entry) {
                    var parentEl = document.getElementById(parentId);
                    var nextEntry = Array.from(parentEl.children).find((el) => el.dataset.title > entry.dataset.title);
                    if (nextEntry === undefined) {
                        parentEl.appendChild(entry);
                    } else {
                        nextEntry.before(entry);
                    }
                }

                var title = entry.dataset.title;
                var titleEventSource = showtimesCalendar.getEventSourceById(title);
                if (titleEventSource === null) {
                    entry.style.background = movieDisplayInfo["background_color"];
                    entry.style.color = movieDisplayInfo["text_color"];
                    entry.dataset.visible = "true";
                    
                    insertSortedChild("shown-movies", entry);

                    showMovie(title);
                    addAllToCalendar(showtimesCalendar, (showtime) => showtime["title"] === title).then(function() {
                        updateFilters(showtimesCalendar, listingCalendar);
                    });
                } else {
                    entry.style.background = "white";
                    entry.style.color = movieDisplayInfo["background_color"];
                    entry.dataset.visible = "false";

                    insertSortedChild("hidden-movies", entry);
                    
                    hideMovie(title);
                    titleEventSource.remove();
                    updateFilters(showtimesCalendar, listingCalendar);
                }
            }

            function createMovieListItemEl(showtimesCalendar, listingCalendar, movieListEl, title, displayInfo) {
                var movieDisplayInfo = displayInfo[title];

                var entry = document.createElement('div');
                entry.dataset.title = title;
                entry.style.display = "flex";
                entry.style.alignItems = "center";
                entry.style.border = `thin solid ${movieDisplayInfo["background_color"]}`;
                entry.style.borderRadius = "5px";
                entry.style.margin = "5px";
                entry.style.padding = "5px";
                entry.style.cursor = "pointer";
                entry.dataset.visible = movieDisplayInfo["visible"].toString();
                if (movieDisplayInfo["visible"]) {
                    entry.style.background = movieDisplayInfo["background_color"];
                    entry.style.color = movieDisplayInfo["text_color"];
                } else {
                    entry.style.background = "white";
                    entry.style.color = movieDisplayInfo["background_color"];
                }

                entry.addEventListener("click", (e) => {
                    return movieListClickHandler(showtimesCalendar, listingCalendar, movieListEl, entry, movieDisplayInfo)
                });
                return entry;
            }

            function createMovieListEntry(showtimesCalendar, listingCalendar, movieListEl, title, displayInfo) {
                var entry = createMovieListItemEl(showtimesCalendar, listingCalendar, movieListEl, title, displayInfo);
                entry.appendChild(createMovieListTitleEl(title));
                entry.appendChild(createMovieListOpenListingButton(showtimesCalendar, listingCalendar, displayInfo));

                var sublistId = entry.dataset.visible == "true" ? "shown-movies" : "hidden-movies";
                document.getElementById(sublistId).appendChild(entry);
            }

            function loadShowtimesCallback(result, showtimesCalendar, listingCalendar, scheduleCalendar) {
                var allShowtimes = result["showtimes"];
                var displayInfo = result["display"];

                updateFilters(showtimesCalendar, listingCalendar, allShowtimes, displayInfo);

                var filteredShowtimes = applyShowtimeFilters(allShowtimes, displayInfo);

                showtimesToEventSources(filteredShowtimes, displayInfo).forEach((eventSource) => {
                    showtimesCalendar.addEventSource(eventSource)
                });

                var minStartHour = allShowtimes.map((s) => new Date(s["start_time"]).getHours()).toSorted()[0]
                if (minStartHour !== undefined) {
                    showtimesCalendar.setOption('slotMinTime', `${minStartHour}:00:00`);
                    scheduleCalendar.setOption('slotMinTime', `${minStartHour}:00:00`);
                }

                showtimesCalendar.render();

                resetMovieList();
                var movieListEl = document.getElementById("movie-list");
                Object.entries(displayInfo).toSorted().forEach(([title, display], i) => {
                    createMovieListEntry(showtimesCalendar, listingCalendar, movieListEl, title, displayInfo);
                });
            }

            function renderScheduleCalendar(scheduleCalendar, scheduleCalendarEl, showtimesCalendar) {
                if (showtimesCalendar.view.type !== "timeGridDay") {
                    scheduleCalendarEl.parentElement.style.display = "none";
                } else {
                    var minStartHour = showtimesCalendar.getEvents().map((s) => s.start.getHours()).toSorted()[0]
                    if (minStartHour !== undefined) {
                        scheduleCalendar.setOption('slotMinTime', `${minStartHour}:00:00`);
                    }

                    var start = showtimesCalendar.view.activeStart;
                    var nextDate = new Date(start.getTime());
                    nextDate.setDate(nextDate.getDate() + 1);
                    if (showtimesCalendar.view.activeEnd.getTime() == nextDate.getTime()) {
                        scheduleCalendar.gotoDate(start);
                    }

                    scheduleCalendarEl.parentElement.style.removeProperty("display");
                    scheduleCalendar.render();
                }
            }

            function displayListingCalendar(event, showtimesCalendar, listingCalendar) {
                if (event.newState === "open") {
                    var listingView = "";
                    var titleFormat = false;
                    var listDayFormat = false;
                    switch (showtimesCalendar.view.type) {
                        case "dayGridMonth":
                            listingView = "listMonth";
                            titleFormat = {month: 'long', year: 'numeric'};
                            listDayFormat = {weekday: 'long', month: 'long', day: 'numeric'};
                            break;
                        case "timeGridWeek":
                            listingView = "listWeek";
                            titleFormat = {month: 'long', day: 'numeric', year: 'numeric'};
                            listDayFormat = {weekday: 'long', month: 'long', day: 'numeric'};
                            break;
                        case "timeGridDay":
                            listingView = "listDay";
                            titleFormat = {weekday: 'long', month: 'long', day: 'numeric', year: 'numeric'};
                            break;
                        default: throw new Error(`Unrecognized main calendar view type: ${showtimesCalendar.view.type}`);
                    }

                    listingCalendar.setOption("titleFormat", titleFormat);
                    listingCalendar.setOption("listDayFormat", listDayFormat);

                    var startStr = showtimesCalendar.formatIso(showtimesCalendar.view.activeStart);
                    var endStr = showtimesCalendar.formatIso(showtimesCalendar.view.activeEnd);
                    listingCalendar.changeView(listingView, {"start": startStr, "end": endStr});
                    listingCalendar.getEventSources().forEach((eventSource, i) => eventSource.remove());
                    listingCalendar.render();
                }
            }

            function showtimeClickHandler(eventClickInfo, scheduleCalendar) {
                if (eventClickInfo.jsEvent.ctrlKey) {
                    scheduleCalendar.addEvent(eventClickInfo.event);
                } else {
                    var showtime = eventClickInfo.event;
                    var showtimeDetails = showtime.extendedProps["showtime"];

                    var startDisplayStr = timeStr(showtime.start);
                    var endDisplayStr = showtime.end === null ? "???" : timeStr(showtime.end);

                    var headerEl = document.createElement("h2");
                    headerEl.innerHTML = showtimeDetails["title"];
                    headerEl.style.margin = "0px 0px 5px 0px";

                    var timeEl = document.createElement("div");
                    timeEl.innerHTML = `<i>${startDisplayStr} - ${endDisplayStr}</i>`;

                    var formatStr = showtimeDetails["format"];
                    if (showtimeDetails["is_open_caption"]) {
                        formatStr += ", Open Caption";
                    }
                    if (showtimeDetails["no_alist"]) {
                        formatStr += ", No A-List";
                    }

                    var detailsEl = document.createElement("div");
                    detailsEl.innerHTML = formatStr;

                    var showtimeDetailsPopover = document.getElementById("showtime-details");
                    showtimeDetailsPopover.innerHTML = "";
                    showtimeDetailsPopover.appendChild(headerEl);
                    showtimeDetailsPopover.appendChild(timeEl);
                    showtimeDetailsPopover.appendChild(document.createElement("hr"));
                    showtimeDetailsPopover.appendChild(detailsEl);
                    showtimeDetailsPopover.showPopover();
                }
            }

            function theaterClickHandler(event, showtimesCalendar, listingCalendar, scheduleCalendar) {
                var theater = event.target.textContent.trim();
                const button = document.getElementById("theater-selected");
                button.innerHTML = theater;

                // Visual feedback
                button.style.transform = 'scale(0.95)';
                setTimeout(() => {
                    button.style.transform = '';
                }, 300);

                var startStr = showtimesCalendar.formatIso(showtimesCalendar.view.activeStart);
                var endStr = showtimesCalendar.formatIso(showtimesCalendar.view.activeEnd);
                clearCalendar(showtimesCalendar);
                getSchedule(theater, startStr, endStr).then((result) => {
                    loadShowtimesCallback(result, showtimesCalendar, listingCalendar, scheduleCalendar);
                });
            }

            document.addEventListener('DOMContentLoaded', function() {
                var showtimesCalendarEl = document.getElementById('showtimes-calendar');
                var showtimesCalendar = new FullCalendar.Calendar(showtimesCalendarEl, {
                    initialView: 'dayGridMonth',
                    contentHeight: "auto",
                    nextDayThreshold: '2:00:00',
                    allDaySlot: false,
                    slotMinTime: '09:00:00',
                    fixedWeekCount: false,
                    headerToolbar: {
                        left: 'prev,next',
                        center: 'title',
                        right: 'dayGridMonth,timeGridWeek,timeGridDay'
                    },
                    datesSet: (dateInfo) => {
                        var endStr = showtimesCalendar.formatIso(dateInfo.end);
                        var startStr = showtimesCalendar.formatIso(dateInfo.start);
                        var theater = selectedTheater();

                        clearCalendar(showtimesCalendar);
                        getSchedule(theater, startStr, endStr).then((result) => {
                            loadShowtimesCallback(result, showtimesCalendar, listingCalendar, scheduleCalendar);
                            renderScheduleCalendar(scheduleCalendar, scheduleCalendarEl, showtimesCalendar);
                        });
                    },
                    eventClick: (event) => showtimeClickHandler(event, scheduleCalendar)
                });
                showtimesCalendar.render();

                var scheduleCalendarEl = document.getElementById('schedule-calendar');
                var scheduleCalendar = new FullCalendar.Calendar(scheduleCalendarEl, {
                    initialView: 'timeGridDay',
                    contentHeight: "auto",
                    nextDayThreshold: '2:00:00',
                    allDaySlot: false,
                    slotMinTime: '09:00:00',
                    customButtons: {
                        exportButton: {
                            text: 'Export ICS',
                            click: function() {
                                var body = {
                                    showtimes: scheduleCalendar.getEvents()
                                        .filter((e) => scheduleCalendar.view.activeStart <= e.start && scheduleCalendar.view.activeEnd >= e.start)
                                        .map((e) => e.extendedProps["showtime"])
                                }
                                post(`export-ics`, body).then((result) => {
                                    window.location = "data:text/calendar," + encodeURIComponent(result);
                                });
                            }
                        }
                    },
                    headerToolbar: {
                        right: false,
                        center: 'exportButton',
                        left: false
                    },
                    eventClick: function(clickInfo) {
                        clickInfo.event.remove();
                    }
                });
                scheduleCalendar.render();

                var listingCalendarEl = document.getElementById("listing-calendar");
                var listingCalendar = new FullCalendar.Calendar(listingCalendarEl, {
                    initialView: 'listWeek',
                    contentHeight: "auto",
                    allDaySlot: false,
                    headerToolbar: {
                        left: '',
                        center: 'title',
                        right: ''
                    },
                    listDayFormat: {weekday: 'long', month: 'long', day: 'numeric'},
                    listDaySideFormat: false
                });

                document.getElementById("movie-showtime-listing").addEventListener("beforetoggle", (event) => {
                    displayListingCalendar(event, showtimesCalendar, listingCalendar);
                });

                document.querySelectorAll("#theater-options .dropdown-item").forEach(item => {
                    item.addEventListener("click", (e) => {
                        theaterClickHandler(e, showtimesCalendar, listingCalendar, scheduleCalendar);
                    });
                });
            });
        </script>
    </head>
    <body>
        <div popover id="showtime-details" style="width: 15%; height: 40%; padding: 10px;"></div>
        <div popover id="movie-showtime-listing" style="width: 25%; height: 65%;">
            <div id='listing-calendar'></div>
        </div>
        <div style="display: flex;">
            <div style="flex: 10%; padding-right: 50px">
                <div class="dropdown" style="margin-top: 20px;">
                    <button id="theater-selected" class="dropdown-toggle">AMC Methuen</button>
                    <div id="theater-options" class="dropdown-menu">
                        <a href="#" class="dropdown-item">AMC Methuen</a>
                        <a href="#" class="dropdown-item">AMC Tyngsboro</a>
                        <a href="#" class="dropdown-item">AMC Boston Common</a>
                        <a href="#" class="dropdown-item">AMC Causeway</a>
                        <a href="#" class="dropdown-item">Apple Hooksett</a>
                        <a href="#" class="dropdown-item">Apple Merrimack</a>
                        <a href="#" class="dropdown-item">Showcase Randolph</a>
                        <a href="#" class="dropdown-item">O'Neil Epping</a>
                        <a href="#" class="dropdown-item">O'Neil Londonderry</a>
                    </div>
                </div>
                <hr />
                <div id="filter-toggles">
                    <div id="negative-filter-toggles"></div>
                    <div id="format-filter-toggles"></div>
                </div>
                <hr />
                <div id="movie-list">
                    <div id="shown-movies"></div>
                    <div id="hidden-movies"></div>
                </div>
            </div>
            <div style="flex: 90%">
                <div style="display: flex;">
                    <div style="flex: 83%; padding-right: 50px;">
                        <div id='showtimes-calendar'></div>
                    </div>
                    <div style="flex: 17%; display: none; padding-right: 10px;">
                        <div id='schedule-calendar'></div>
                    </div>
                </div>
            </div>
        </div>
    </body>
</html>
